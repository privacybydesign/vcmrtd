<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-info/aa" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Active Authentication (AA) | DMRTD Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://privacybydesign.github.io/dmrtd/info/aa"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Active Authentication (AA) | DMRTD Documentation"><meta data-rh="true" name="description" content="Active Authentication is an optional security protocol aimed at detecting cloning of passport chips. Where Passive Authentication verifies the data, Active Authentication verifies the chip’s uniqueness. It’s essentially a challenge-response protocol using an asymmetric key pair embedded in the passport If a passport supports AA, it will have:"><meta data-rh="true" property="og:description" content="Active Authentication is an optional security protocol aimed at detecting cloning of passport chips. Where Passive Authentication verifies the data, Active Authentication verifies the chip’s uniqueness. It’s essentially a challenge-response protocol using an asymmetric key pair embedded in the passport If a passport supports AA, it will have:"><link data-rh="true" rel="icon" href="/dmrtd/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://privacybydesign.github.io/dmrtd/info/aa"><link data-rh="true" rel="alternate" href="https://privacybydesign.github.io/dmrtd/info/aa" hreflang="en"><link data-rh="true" rel="alternate" href="https://privacybydesign.github.io/dmrtd/info/aa" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Active Authentication (AA)","item":"https://privacybydesign.github.io/dmrtd/info/aa"}]}</script><link rel="stylesheet" href="/dmrtd/assets/css/styles.c025fc16.css">
<script src="/dmrtd/assets/js/runtime~main.5e3be5ef.js" defer="defer"></script>
<script src="/dmrtd/assets/js/main.c1a342b4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dmrtd/"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dmrtd/">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/dmrtd/">Overview</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/">Passport based Veriable Credentials</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/dmrtd/dmrtd/app">Example Mobile Application</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/dmrtd/app">Mobile App</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/dmrtd/library/support">Passport based Veriable Credentials</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/library/support">Passport Model Support Table</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/library/flow">Sequence diagram</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/dmrtd/info/aa">Background information</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dmrtd/info/aa">Active Authentication (AA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/info/bac">Basic Access Control (BAC)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/info/pace">Password Authenticated Connection Establishment (PACE)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/info/pa">Passive Authentication (PA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/info/standards">Passport Standards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/info/pki">Understanding the Passport PKI Trust Chain</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/dmrtd/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Background information</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Active Authentication (AA)</span></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>Active Authentication (AA)</h1></header>
<p>Active Authentication is an optional security protocol aimed at detecting cloning of passport chips. Where Passive Authentication verifies the data, Active Authentication verifies the chip’s uniqueness. It’s essentially a challenge-response protocol using an asymmetric key pair embedded in the passport: the chip proves it holds a private key that corresponds to a public key stored in the passport’s data, thereby confirming that this is not just a copy of the data on another chip. How it works: If a passport supports AA, it will have:</p>
<ul>
<li>A private key securely stored on the chip (inaccessible for reading).</li>
<li>The corresponding public key stored in Data Group 15 (DG15). DG15 may include the key algorithm info (e.g., RSA 1024-bit or 2048-bit modulus, or an ECC public key point, etc.). The hash of this public key is also included in the EF.SOD signature, meaning any alteration of the key would be detected by Passive Auth.</li>
</ul>
<p>During inspection, after BAC (so the communication is secure), the reader may perform Active Authentication as follows:</p>
<ol>
<li>The terminal reads DG15 to obtain the chip’s public key (let’s call it Pub_AA).</li>
<li>The terminal generates a random challenge (usually 8 bytes as per the standard). It sends this challenge to the chip in an INTERNAL AUTHENTICATE APDU.</li>
<li>The chip, upon receiving the challenge, may also generate its own random (some implementations do this to ensure it’s not replayable). According to ICAO 9303, the chip could concatenate its own random R<sub>ICC</sub> with the terminal’s challenge R<sub>IFD</sub>, and perhaps hash them, then sign the result with its private key. (One common method: the chip signs R<sub>IFD</sub> || R<sub>ICC</sub> or a hash thereof.)</li>
<li>The chip returns the signature (and possibly its random if used) to the terminal.</li>
<li>The terminal verifies the signature using the public key from DG15. If the signature is correct, it proves the chip had the matching private key, meaning this chip is the genuine one originally issued with that passport’s data.</li>
</ol>
<p>If an attacker only cloned the data onto another chip, they would not have the original chip’s private key, so they would fail to produce a valid signature in step 5. Thus, AA is effective against cloning attacks where someone tries to use a copied data (since Passive Auth would still pass on a clone, AA adds an extra check).</p>
<p><strong>Algorithm and standards</strong>: The challenge-response in AA is based on ISO 9796-2 (for RSA) or analogous for ECDSA. Many passports historically used RSA keys (1024-bit) for AA. Newer ones might use ECC (with smaller key sizes but strong security). The protocol is simple: sign a nonce. It’s important that the nonce be unique per session (terminal ensures that by generating random, chip often adds its own random too). Also, to avoid replay, the chip’s random or the fact that the challenge is different ensures an attacker can’t replay a known signature.</p>
<p><strong>Privacy consideration</strong>: Active Authentication does have a privacy implication: the chip’s public key is static and unique per passport. If an attacker could trigger AA and get a signature, in theory they could identify the passport by that signature (since the public key acts like an ID). A known attack is that if someone could query a passport at two different places, they could confirm it’s the same passport by checking the public key or verifying a signature with a previously seen public key. This is mitigated by the need to do BAC first (so random people can’t do AA without MRZ), but BAC keys can sometimes be guessed or the attacker might be an insider. Germany and some other countries considered this a &quot;privacy threat&quot; – the scenario described by Riha is that an inspection system could craft a challenge that encodes location/time, and later show the signed challenge as proof that a passport was present at that place/time (non-repudiation issue). Because of such concerns, Germany, and others (Greece, Italy, France) chose not to implement Active Authentication in their e-passports. They instead relied on the later Chip Authentication as part of EAC for anti-cloning (which is done under secure messaging and doesn’t reveal a static public key to eavesdroppers, thereby avoiding the traceability issue).</p>
<p><strong>Active Auth vs. Chip Auth</strong>: Active Authentication was the first-gen solution to cloning. Chip Authentication (in EAC) can be seen as a replacement in newer passports (it achieves the same goal but in a more sophisticated way). Indeed, Chip Auth subsumes AA’s role and also sets up new session keys, removing the traceability problem. Many passports that implement EAC skip AA. Some implement both (to remain compatible or add redundancy).</p>
<p><strong>When/How it’s run</strong>: Typically, if AA is supported, the inspection system will do it right after BAC and before reading too many files (or at least before concluding the session). For example, an order might be: BAC -&gt; read DG1/DG2 -&gt; do AA -&gt; then proceed. It doesn’t strictly have to be before reading, but since AA doesn’t require reading any more files (just uses DG15), it’s efficient to do it early. Doing it after reading doesn’t add benefit because if a clone was present, all data read was from clone already. Some systems might even do AA after reading to cross-check, but logically sooner is better.</p>
<p><strong>Cloning and relay</strong>: Note that AA can be defeated by a relay attack: An attacker with a cloned chip could secretly communicate with the genuine passport in the victim’s pocket over some channel (like using two radio devices). The clone, when asked to do AA, relays the challenge to the genuine passport (which is perhaps close by) and relays back the signature. This way the clone chip itself doesn’t need the private key; it just “asks” the real one over the air. This is a man-in-the-middle attack and has been demonstrated (known as the “ghost and leech” attack). Such an attack is high-tech and requires the genuine passport to be in range (and BAC keys known, etc.), but it’s theoretically possible. It shows that even AA isn’t foolproof if someone can proxy the communication (which BAC was supposed to prevent by requiring physical proximity to see MRZ, but if the attacker has that, they might as well just steal the passport outright!). Nonetheless, it’s a noted vulnerability in research.</p>
<p><strong>Library implementation</strong>:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final passport = Passport(_nfc);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Assuming you have a passport object with methods to read DG15 and perform AA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Read the public key from DG15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final dg15 = await passport.readEfDG15();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Perform Active Authentication note the challenge size is typically 8 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final aaSig = await passport.activeAuthenticate(Uint8List(8));</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/dmrtd/library/flow"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Sequence diagram</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/dmrtd/info/bac"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Basic Access Control (BAC)</div></a></nav></div></div></div></div></main></div></div></div></div>
</body>
</html>