"use strict";(self.webpackChunkdmrtd_docs=self.webpackChunkdmrtd_docs||[]).push([[7519],{6548:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>o,contentTitle:()=>p,default:()=>d,frontMatter:()=>t,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"library/flow","title":"Passport Issuance Flows","description":"There are two distinct flows for issuing a passport-based credential, depending on whether the process is initiated in the Example App or directly inside the Yivi App. The overall sequence of interactions is very similar (scanning MRZ, NFC reading, validation at the issuer, IRMA issuance), but there is one important difference:","source":"@site/docs/library/flow.md","sourceDirName":"library","slug":"/library/flow","permalink":"/vcmrtd/library/flow","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docSidebar","previous":{"title":"Passport Model Support Table","permalink":"/vcmrtd/library/support"},"next":{"title":"Active Authentication (AA)","permalink":"/vcmrtd/info/aa"}}');var n=s(4848),i=s(8453);const t={},p="Passport Issuance Flows",o={},l=[{value:"Key Differences",id:"key-differences",level:2},{value:"Sequence diagrams",id:"sequence-diagrams",level:2},{value:"Example App",id:"example-app",level:3},{value:"Yivi App",id:"yivi-app",level:3}];function c(e){const r={h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"passport-issuance-flows",children:"Passport Issuance Flows"})}),"\n",(0,n.jsxs)(r.p,{children:["There are ",(0,n.jsx)(r.strong,{children:"two distinct flows"})," for issuing a passport-based credential, depending on whether the process is initiated in the ",(0,n.jsx)(r.strong,{children:"Example App"})," or directly inside the ",(0,n.jsx)(r.strong,{children:"Yivi App"}),". The overall sequence of interactions is very similar (scanning MRZ, NFC reading, validation at the issuer, IRMA issuance), but there is one important difference:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["In the ",(0,n.jsx)(r.strong,{children:"Example App flow"}),", the Example App orchestrates the NFC reading and validation, then hands over to the Yivi App via a universal link to complete the issuance."]}),"\n",(0,n.jsxs)(r.li,{children:["In the ",(0,n.jsx)(r.strong,{children:"Yivi App flow"}),", all steps (including NFC reading, issuer communication, and credential storage) are handled within the Yivi App itself. No external app is needed."]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"key-differences",children:"Key Differences"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Example App"}),":"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Acts as a \u201cproxy\u201d between the user and Yivi."}),"\n",(0,n.jsx)(r.li,{children:"Performs NFC reading, passive and active authentication locally."}),"\n",(0,n.jsx)(r.li,{children:"Only after obtaining issuer validation does it pass the issuance request to the Yivi App via a universal link."}),"\n",(0,n.jsx)(r.li,{children:"Yivi App is only involved at the final stage: the actual credential issuance and storage."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Yivi App"}),":"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Acts as a self-contained flow."}),"\n",(0,n.jsx)(r.li,{children:"Handles the entire process from MRZ scanning, NFC reading, issuer communication, to credential storage."}),"\n",(0,n.jsx)(r.li,{children:"No need to context switch between apps."}),"\n",(0,n.jsx)(r.li,{children:"This is closer to what a real-world user flow would look like in production."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"sequence-diagrams",children:"Sequence diagrams"}),"\n",(0,n.jsx)(r.h3,{id:"example-app",children:"Example App"}),"\n",(0,n.jsx)(r.mermaid,{value:'sequenceDiagram\r\n    participant User\r\n    participant ExampleApp\r\n    participant YiviApp\r\n    participant Passport\r\n    participant PassportIssuer\r\n    participant IrmaServer\r\n\r\n    User->>ExampleApp: Open Yivi App\r\n    activate ExampleApp\r\n    User->>ExampleApp: Select "Start Passport Issuance"\r\n    ExampleApp->>PassportIssuer: start-validation\r\n    activate PassportIssuer\r\n    PassportIssuer--\x3e>ExampleApp: sessionId, nonce\r\n    deactivate PassportIssuer\r\n\r\n    alt MRZ scanned via camera\r\n        ExampleApp->>User: Show MRZ scanner\r\n        User->>Passport: Show passport data page\r\n        activate Passport\r\n        ExampleApp->>Passport: OCR MRZ from passport\r\n        Passport--\x3e>ExampleApp: MRZ Data\r\n        deactivate Passport\r\n    else Manual entry\r\n        ExampleApp->>User: Request manual MRZ input\r\n        User->>ExampleApp: Enter date of birth, expiry, doc number\r\n    end\r\n\r\n    ExampleApp->>User: Request NFC to be enabled\r\n    User->>Passport: Tap passport on phone\r\n    activate Passport\r\n\r\n    ExampleApp->>Passport: Perform BAC or PACE\r\n    Passport--\x3e>ExampleApp: Authenticated\r\n    ExampleApp->>Passport: Read Data Groups\r\n    Passport--\x3e>ExampleApp: DataGroups\r\n    ExampleApp->>Passport: Read EF.SOD\r\n    Passport--\x3e>ExampleApp: EF.SOD\r\n    ExampleApp->>Passport: Perform Active Auth (if supported, with nonce)\r\n    Passport--\x3e>ExampleApp: ActiveAuth signature\r\n    deactivate Passport\r\n\r\n    ExampleApp->>PassportIssuer: Send sessionId, dataGroups, EF.SOD, activeAuthSig\r\n    activate PassportIssuer\r\n    PassportIssuer->>PassportIssuer: Perform Passive Auth (CSCA check)\r\n    PassportIssuer->>PassportIssuer: Validate Active Auth (nonce/sessionId)\r\n\r\n    PassportIssuer->>ExampleApp: Return IRMA issuance request (signed JWT, IrmaServer info)\r\n    deactivate PassportIssuer\r\n\r\n    ExampleApp->>IrmaServer: Start issuance session with JWT\r\n    activate IrmaServer\r\n    IrmaServer--\x3e>ExampleApp: Return IRMA session pointer\r\n    ExampleApp->>IrmaServer: Start IRMA session\r\n    ExampleApp->>ExampleApp: Construct Yivi universal link\r\n    ExampleApp->>YiviApp: Open Yivi App with Universal link\r\n    activate YiviApp\r\n    deactivate ExampleApp\r\n    YiviApp->>IrmaServer: Start IRMA session\r\n    IrmaServer--\x3e>YiviApp: Return credential\r\n    YiviApp->>YiviApp: Store credential\r\n    deactivate YiviApp\r\n    deactivate IrmaServer'}),"\n",(0,n.jsx)(r.h3,{id:"yivi-app",children:"Yivi App"}),"\n",(0,n.jsx)(r.mermaid,{value:'sequenceDiagram\r\n    participant User\r\n    participant YiviApp\r\n    participant Passport\r\n    participant PassportIssuer\r\n    participant IrmaServer\r\n\r\n    User->>YiviApp: Open Yivi App\r\n    activate YiviApp\r\n    User->>YiviApp: Select "Start Passport Issuance"\r\n    YiviApp->>PassportIssuer: start-validation\r\n    activate PassportIssuer\r\n    PassportIssuer--\x3e>YiviApp: sessionId, nonce\r\n    deactivate PassportIssuer\r\n\r\n    alt MRZ scanned via camera\r\n        YiviApp->>User: Show MRZ scanner\r\n        User->>Passport: Show passport data page\r\n        activate Passport\r\n        YiviApp->>Passport: OCR MRZ from passport\r\n        Passport--\x3e>YiviApp: MRZ Data\r\n        deactivate Passport\r\n    else Manual entry\r\n        YiviApp->>User: Request manual MRZ input\r\n        User->>YiviApp: Enter date of birth, expiry, doc number\r\n    end\r\n\r\n    YiviApp->>User: Request NFC to be enabled\r\n    User->>Passport: Tap passport on phone\r\n    activate Passport\r\n\r\n    YiviApp->>Passport: Perform BAC or PACE\r\n    Passport--\x3e>YiviApp: Authenticated\r\n    YiviApp->>Passport: Read Data Groups\r\n    Passport--\x3e>YiviApp: DataGroups\r\n    YiviApp->>Passport: Read EF.SOD\r\n    Passport--\x3e>YiviApp: EF.SOD\r\n    YiviApp->>Passport: Perform Active Auth (if supported, with nonce)\r\n    Passport--\x3e>YiviApp: ActiveAuth signature\r\n    deactivate Passport\r\n\r\n    YiviApp->>PassportIssuer: Send sessionId, dataGroups, EF.SOD, activeAuthSig\r\n    activate PassportIssuer\r\n    PassportIssuer->>PassportIssuer: Perform Passive Auth (CSCA check)\r\n    PassportIssuer->>PassportIssuer: Validate Active Auth (nonce/sessionId)\r\n\r\n    PassportIssuer->>YiviApp: Return IRMA issuance request (signed JWT, IrmaServer info)\r\n    deactivate PassportIssuer\r\n\r\n    YiviApp->>IrmaServer: Start issuance session with JWT\r\n    activate IrmaServer\r\n    IrmaServer--\x3e>YiviApp: Return IRMA session pointer\r\n    YiviApp->>IrmaServer: Start IRMA session\r\n    IrmaServer--\x3e>YiviApp: Return credential\r\n    YiviApp->>YiviApp: Store credential\r\n    deactivate IrmaServer\r\n\r\n    deactivate YiviApp'})]})}function d(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}}}]);