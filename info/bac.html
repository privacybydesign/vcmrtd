<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-info/bac" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Basic Access Control (BAC) | DMRTD Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://privacybydesign.github.io/dmrtd/info/bac"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Basic Access Control (BAC) | DMRTD Documentation"><meta data-rh="true" name="description" content="Basic Access Control is a protocol designed to protect the content of the e-passport chip from unauthorized reading (skimming or eavesdropping) by requiring that the reader prove knowledge of the passport’s MRZ information. In simpler terms, BAC uses information printed in the passport (MRZ) to derive encryption keys, and establishes a encrypted session between the chip and the reader. Only someone who has physically seen the passport (and thus knows the MRZ) can perform BAC successfully, thereby mitigating the risk of someone reading your passport data without your consent from a distance."><meta data-rh="true" property="og:description" content="Basic Access Control is a protocol designed to protect the content of the e-passport chip from unauthorized reading (skimming or eavesdropping) by requiring that the reader prove knowledge of the passport’s MRZ information. In simpler terms, BAC uses information printed in the passport (MRZ) to derive encryption keys, and establishes a encrypted session between the chip and the reader. Only someone who has physically seen the passport (and thus knows the MRZ) can perform BAC successfully, thereby mitigating the risk of someone reading your passport data without your consent from a distance."><link data-rh="true" rel="icon" href="/dmrtd/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://privacybydesign.github.io/dmrtd/info/bac"><link data-rh="true" rel="alternate" href="https://privacybydesign.github.io/dmrtd/info/bac" hreflang="en"><link data-rh="true" rel="alternate" href="https://privacybydesign.github.io/dmrtd/info/bac" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Basic Access Control (BAC)","item":"https://privacybydesign.github.io/dmrtd/info/bac"}]}</script><link rel="stylesheet" href="/dmrtd/assets/css/styles.c025fc16.css">
<script src="/dmrtd/assets/js/runtime~main.d136baee.js" defer="defer"></script>
<script src="/dmrtd/assets/js/main.8d6f8c8c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dmrtd/"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dmrtd/">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/dmrtd/">Overview</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/">Passport based Veriable Credentials</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/dmrtd/dmrtd/app">Example Mobile Application</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/dmrtd/app">Mobile App</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/dmrtd/library/support">Passport based Veriable Credentials</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/library/support">Passport Model Support Table</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/dmrtd/info/aa">Background information</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/info/aa">Active Authentication (AA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dmrtd/info/bac">Basic Access Control (BAC)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/info/pace">Password Authenticated Connection Establishment (PACE)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/info/pa">Passive Authentication (PA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/info/standards">Passport Standards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dmrtd/info/pki">PKI</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/dmrtd/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Background information</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Basic Access Control (BAC)</span></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>Basic Access Control (BAC)</h1></header>
<p>Basic Access Control is a protocol designed to protect the content of the e-passport chip from unauthorized reading (skimming or eavesdropping) by requiring that the reader prove knowledge of the passport’s MRZ information. In simpler terms, BAC uses information printed in the passport (MRZ) to derive encryption keys, and establishes a encrypted session between the chip and the reader. Only someone who has physically seen the passport (and thus knows the MRZ) can perform BAC successfully, thereby mitigating the risk of someone reading your passport data without your consent from a distance.</p>
<p><strong>Key derivation</strong>. The passport’s MRZ data (specifically, <strong>the document number</strong>, <strong>date of birth</strong>, and <strong>expiration date</strong>, along with their check digits) are used to compute two 56-bit keys (plus parity bits making them into two 64-bit keys) for Triple-DES (3DES) encryption. The process as specified by ICAO: those MRZ fields are concatenated into a 16 or 32 byte value (depending on spec version), then hashed (earlier versions used SHA-1, taking the first 16 bytes of the SHA-1 output as the two keys). The result is two DES keys: one for encryption (called <code>K_ENC</code>) and one for message authentication (<code>K_MAC</code>). These keys are the Document Basic Access Keys, essentially a shared secret between the passport and any reader that knows the MRZ. Because MRZs are not highly random, the effective strength of these keys is about 56–64 bits of entropy in early implementations.</p>
<p><strong>The BAC protocol (handshake)</strong>: BAC is essentially a challenge-response protocol based on ISO/IEC 9798-2. It goes like this (assuming the reader has optically read the MRZ from the passport):</p>
<ol>
<li>The reader issues a SELECT command to select the ePassport application, then issues a GET CHALLENGE command. The chip responds with an 8-byte random number <code>R&lt;sub&gt;ICC&lt;/sub&gt;</code> (the chip’s random challenge).</li>
<li>The reader then generates its own 8-byte random R<sub>IFD</sub>. The reader now has:<!-- -->
<ul>
<li>Chip’s challenge R<sub>ICC</sub>,</li>
<li>Its own challenge R<sub>IFD</sub>,</li>
<li>The two shared secret keys (K_ENC, K_MAC) derived from MRZ.</li>
</ul>
</li>
<li>The reader constructs a cryptogram consisting of R<sub>ICC</sub> || R<sub>IFD</sub> || some other data (like a key seed or identifier; in BAC specifically, it includes a 16-byte random and then the two randoms again for key derivation, but that detail is internal). It then encrypts this with K_ENC and appends a MAC (using K_MAC), and sends it to the chip using the EXTERNAL AUTHENTICATE command.</li>
<li>The chip receives this, decrypts it with its own copy of K_ENC (since the chip also can derive keys from MRZ stored internally) and verifies the MAC with K_MAC. If everything is correct (meaning the reader knew the right keys, and the message integrity is good), the chip then similarly responds by encrypting a cryptogram (often just R<sub>IFD</sub> maybe modified, or some agreed value) with a MAC in an INTERNAL AUTHENTICATE response (in practice, the standard uses mutual auth so both sides prove knowledge). The details per spec: the chip will take the reader’s random, its own random, maybe do some DES operations (the spec defines this precisely), and send back an 8-byte token encrypted and MACed.</li>
<li>If the reader successfully decrypts and verifies the chip’s response, both sides are now assured they share the secret keys. At this point, Secure Messaging (SM) is activated: both parties derive session keys from the exchanged randoms for ongoing encryption and MAC of all further APDUs. Typically, they derive new keys (like session K_ENC&#x27; and K_MAC&#x27;) from R<sub>ICC</sub> and R<sub>IFD</sub> to use thereafter, although some implementations just continue using the same keys for session – the standard suggests deriving fresh session keys to avoid reusing the static MRZ-based ones any longer than needed.</li>
</ol>
<p>After BAC is successfully performed, the communication channel between the reader and passport is encrypted (with 3DES) and MAC-protected. This means an eavesdropper can no longer read plaintext data or insert commands easily. Also, the chip will refuse to output personal information from DG1, DG2, etc., unless BAC succeeded; if you try to read without doing BAC, it will give an error or no response (this prevents skimming).</p>
<p><strong>BAC’s practical necessity</strong>: In early days, some worried that radio chips could be read from a distance without someone opening the passport. BAC mitigates that because you need the MRZ to do it. The MRZ is inside the passport, and often passports have RF shielding in the cover (for instance, the U.S. added a metallic mesh in the cover) to prevent reading when closed. So an attacker would have to physically open the passport or at least know the details to get the keys, making “skimming” much harder. BAC also provides some level of privacy for the basic data (everything remains encrypted on the air).</p>
<p>Known vulnerabilities of BAC: While clever for its time, BAC has a number of weaknesses:</p>
<ul>
<li>
<p><strong>Low entropy keys / Guessability</strong>: The MRZ data has relatively low entropy. Many countries used sequential passport numbers, and an attacker might often know or guess a person’s birth date or expiration date range. This dramatically reduces the search space. In fact, researchers demonstrated in 2007 that by eavesdropping one BAC exchange (which was 3DES encrypted) from a few meters away, they could brute-force the keys in under a minute for some passports (Germany, Netherlands). They took advantage of known passport number patterns and the limited entropy of date-of-birth (people typically not older than 100, etc.) to shrink the brute force effort. Even without eavesdropping, another attack was possible: if an attacker had physical proximity, they could try to brute-force BAC by repeatedly attempting sessions (though this is slower and chips often have rate limits). But using a recorded session, one can test candidate MRZ keys offline by attempting to decrypt the transcript. As Henderson summarizes: “the combination of Triple DES encryption and a short MRZ means it’s not very secure at all.”. The MRZ key space was effectively around 2^40 to 2^50 for many passports, which by today’s computing is feasible.</p>
</li>
<li>
<p><strong>Eavesdropping and brute force</strong>: As mentioned, if BAC is used and an attacker sniffs the communication, they can later brute force the session keys. BAC does not use any forward secrecy – the static keys derived from MRZ protect the whole session. If those keys are found, the attacker can decrypt all the data that was exchanged (which could include the face image, etc.). This is a real concern, especially before PACE was introduced. The 2007 attack referenced by Henderson cracked BAC keys in &lt; 30 seconds with specialized hardware.</p>
</li>
<li>
<p><strong>Replay and tracing</strong>: The BAC protocol itself, if badly implemented, could allow replay of an authentication attempt or telltale differences if the wrong key is used. For example, one attack (Chothia 2010) found that some chips took noticeably longer to respond if you sent a properly encrypted (MACed) message versus a random one, even if you hadn’t done BAC with the right key. By recording one valid BAC session message and replaying it, an attacker could basically “ping” a passport to see if that message’s MAC is valid under some key – if the timing is different, they learned something, possibly even allowing them to confirm a passport’s identity (traceability attack) or to brute force the key one byte at a time through timing analysis. One such advanced attack by Sportiello in 2014 combined a timing side channel with partial brute force to recover the BAC key without even eavesdropping a session (it required interacting with the passport for many hours though). These attacks exploit implementation flaws (chips should take constant time for invalid auth attempts, but not all did).</p>
</li>
<li>
<p><strong>Backwards compatibility dependency</strong>: BAC is not an elegant protocol by modern standards (it uses 3DES and no forward secrecy). It persisted until mid-2010s, and even when PACE was introduced, passports often had to support BAC as a fallback. This means an attacker could force a downgrade to BAC in some cases if a reader isn’t configured to prefer PACE. The presence of BAC means the vulnerabilities might still be exploitable if an inspection system doesn’t enforce using PACE. By 2023, researchers noted that many passports still support BAC and thus remain vulnerable to any new BAC attacks even if the primary method is PACE.</p>
</li>
</ul>
<p>Despite its weaknesses, BAC did succeed in preventing casual skimming in the early years. There have been no reports of widespread data theft via BAC brute forcing in the field (likely because one needs either physical access or a good antenna very close to the passport, plus significant computing power). However, as a library developer, one should be aware that if a passport supports PACE, it’s far better to use PACE (we’ll cover that next), and that BAC keys can be brute-forced if someone obtains a transcript. Also, some passports might not implement BAC correctly (in the “Implementation notes” we will mention a French passport bug where error codes differed, etc.).</p>
<p><strong>Library implementation</strong>: In a library, implementing BAC involves:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Assuming you have a passport object with methods to read MRZ and perform BAC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final passport = Passport(_nfc);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Read MRZ from the passport (this is usually done by optical scanning)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final accesKey = DBAKey(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      docNumber,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      birthDate,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expiryDate,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      paceMode: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await passport.startSession(accessKey as DBAKey);</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/dmrtd/info/aa"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Active Authentication (AA)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/dmrtd/info/pace"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Password Authenticated Connection Establishment (PACE)</div></a></nav></div></div></div></div></main></div></div></div></div>
</body>
</html>